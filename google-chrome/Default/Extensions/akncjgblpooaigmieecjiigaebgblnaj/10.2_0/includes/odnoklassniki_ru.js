!function(e){function t(t){for(var o,i,s=t[0],d=t[1],c=t[2],u=0,f=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(o in d)Object.prototype.hasOwnProperty.call(d,o)&&(e[o]=d[o]);for(l&&l(t);f.length;)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var d=n[s];0!==a[d]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={9:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.savefromContentScriptWebpackJsonp=window.savefromContentScriptWebpackJsonp||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=d;r.push([106,0]),n()}({106:function(e,t,n){"use strict";n.r(t);var o=n(5),a=n(6),r=n(14),i=n(10),s=n(20),d=n(4),c=n(2),l=n.n(c),u=n(0),f=n(16),p=n(25),v=n(37),h=n(35),m=n(33),g=n(49),k=n(21),y=n(31),b=n(26),w=n(42),x=n(8),O=n(3),M=n(24),_=n(11),S=n(12),L=n(68),C=n(28),P=n(18),I=n(45),j=n(19),N=n(73),q=n(15),A=n(29),E=n(17),R=n(48),T=Object(S.a)("odnoklassniki_ru"),D=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome");C.a.isSingle()&&Object(p.b)("odnoklassniki",(function(e,t){var c=Object(f.a)(t),p=t.preferences,S=p.moduleOdnoklassniki?1:0,C=u.a.isChrome||u.a.isFirefox||u.a.isGM&&u.a.isTM;u.a.onMessage.addListener((function(t,n,o){if("getModuleInfo"===t.action){if(t.url!==location.href)return;return o({state:S,moduleName:e})}if("changeState"===t.action){if(e!==t.moduleName)return;return F.changeState(t.state)}"updatePreferences"!==t.action?S&&("updateLinks"===t.action&&B(),"downloadMP3Files"===t.action&&(C?H.downloadMP3Files():H.showListOfAudioFiles(!1)),"downloadPlaylist"===t.action&&H.showListOfAudioFiles(!0)):Object.assign(p,t.preferences)})),S&&setTimeout((function(){F.run()}));var F={linkCache:{},contextMenu:null,videoToken:null,run:function(){if(S=1,H.getJsSessionId(),z.injectStyle(),W.injectStyle(),P.a.isAvailable())return F.mutationMode.enable()},changeState:function(e){S=e,U.rmBtn(),H.disable(),W.rmCurrentPhotoBtn(),z.disable(),z.rmBtn(),F.hideMenu(),F.mutationMode.stop(),F.clearCache(),e&&F.run()},hideMenu:function(){F.contextMenu&&(F.contextMenu.hide(),F.contextMenu=null)},clearCache:function(){var e=F.linkCache;for(var t in e)delete e[t]},mutationMode:{observer:null,stop:function(){this.observer&&this.observer.stop(),["sfSkip"].forEach((function(e){for(var t,n=Object(m.a)(e),o=document.querySelectorAll("["+n+"]"),a=0;t=o[a];a++)t.removeAttribute(n)}))},wrapOnPhotoOver:function(){S&&W.addCurrentDlBtn(this)},wrapVideoFeedOnImgOver:function(){S&&z.onImgOver.call(this)},wrapAudioOnMouseOver:function(){S&&H.onMouseOver.apply(this,arguments)},wrapAudioOnMouseOut:function(){S&&H.onMouseOut.apply(this,arguments)},wrapNewAudioOnMouseEnter:function(){if(S)try{H.onNewMouseEnter.apply(this,arguments)}catch(e){T.error("wrapNewAudioOnMouseEnter error",e)}},enable:function(){if(this.observer)return this.observer.start();var e=this,t=function(t){for(var n,o=0;n=t.added[o];o++)n.sfSkip>0||(n.sfSkip="1",x.a.on(n,"mouseenter",e.wrapAudioOnMouseOver),x.a.on(n,"mouseleave",e.wrapAudioOnMouseOut))},n=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.added.filter((function(e){return!e.dataset.sfReady})).map((function(e){return e.dataset.sfReady=1,e})).map((function(e){var t=document.createElement("a");Object(q.a)({category:"append",subcategory:"ok",event:"b"}),t.classList.add("sf-audio","savefrom_ok_download"),e.style.position="relative",e.appendChild(t),t.style.position="absolute",t.style.top="10px",t.style.right="15px",t.style.width="16px",t.style.height="16px",e.closest(".track-with-cover").addEventListener("mouseleave",(function(){return t.style.display="none"})),e.addEventListener("mouseenter",(function(){t.style.display="block",t.href||E.a.createLinkExtractor("ok-profile_music").extractLinks({element:e}).then((function(e){t.href=e[0].url;var n=e[0].bitrate+" "+u.a.i18n.getMessage("kbps"),o=c.sizeHuman(e[0].size,2);t.title="".concat(o," ~ ").concat(n)}))})),t.addEventListener("click",(function(t){Object(q.a)({category:"download",subcategory:"ok",event:"track"}),t.stopPropagation(),t.preventDefault();var n=e.closest(".track-with-cover"),o=n.querySelector('[data-l="t,artist"]').textContent,a=n.querySelector('[data-l="t,title"]').textContent,r=_.a.modify("".concat(o," - ").concat(a));u.a.sendMessage({action:"downloadFile",options:{filename:r+".mp3",url:t.target.href}})}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(t){for(var n,o=0;n=t.added[o];o++)n.dataset.sfSkip>0||(n.dataset.sfSkip="1",x.a.one(n,"mouseenter",e.wrapVideoFeedOnImgOver))},a=[];"m.ok.ru"===location.host&&a.push({css:".music_track_i:not(.actionButton)",is:"added",callback:function(e){e.added.forEach((function(e){e.sfSkip||(e.sfSkip="1",H.appendDownloadMobileMusic(e))}))}},{css:"#mvplayer_cont, .feed-card_item .vdo.playb, .theme-comments-head [data-video]",is:"added",callback:function(e){e.added.forEach((function(e){if(!e.dataset.sfSkip){e.dataset.sfSkip="1";var t=e.closest(".section, .feed-card, .theme-comments-head");t&&U.appendDownloadMobileVideo(t)}}))}}),this.observer=new P.a({queries:[].concat(a,[{css:".track.js-track, .track-with-cover.h-mod",is:"added",callback:t},{css:".track-with-cover_cnt",is:"added",callback:n},{css:".mus-tr_i",is:"added",callback:t},{css:"#photo-layer_photo",is:"added",callback:function(t){if(!u.a.isSafari)for(var n,o=0;n=t.added[o];o++)n.dataset.sfSkip>0||(n.dataset.sfSkip="1",x.a.one(n,"mouseenter",e.wrapOnPhotoOver))}},{css:".vp_video .vid-card_cnt",is:"added",callback:function(e){for(var t,n=0;t=e.added[n];n++)if(!(t.dataset.sfSkip>0)){t.dataset.sfSkip="1";var o=Object(b.a)(t,".vp_video");if(!o)return;var a=U.getPlayerOptions(t);a&&U.appendLinkUnderVideo(o.parentNode,a,t)}}},{css:".vid-card_cnt .vid-card_cnt_w img",is:"added",callback:function(t){for(var n,o=0;n=t.added[o];o++)if(!(n.dataset.sfSkip>0)){if(n.dataset.sfSkip="1",(n=Object(v.a)(n,"vid-card_cnt")).dataset.sfSkip)return;x.a.one(n,"mouseenter",e.wrapVideoFeedOnImgOver)}}},{css:".d_comment_text_w img",is:"added",callback:o},{css:".video-card .video-card_img-w img",is:"added",callback:o},{css:".vid-card_cnt img, .html5-vpl_vid",is:"added",callback:o},{css:".".concat(x.a.onRemoveClassName),is:"removed",callback:function(e){for(var t,n=0;t=e.removed[n];n++)x.a.onRemoveListener(t)}},{css:".sf-video-feed-bind-on-insert",is:"added",callback:function(e){for(var t,n=e.target,o=0;t=e.added[o];o++)t.addEventListener("click",(function(e){z.onBtnClick(e,this,n)})),Object(q.a)({category:"append",subcategory:"ok",event:"b"})}},{css:["wm-track","wm-track2"],is:"added",callback:function(t){for(var n,o=0;n=t.added[o];o++)n.dataset.sfSkip>0||(n.dataset.sfSkip="1",x.a.one(n,"mouseenter",e.wrapNewAudioOnMouseEnter))}}])})}}},B=function(){F.clearCache(),V(),H.getJsSessionId(),U.catchPopup()},V=function(){for(var e=document.querySelectorAll(".savefrom_ok_download"),t=e.length-1;t>=0;t--)e[t].parentNode.removeChild(e[t])},H={downloadIdPrefix:"savefrom_ok_audio_download_",infoIdPrefix:"savefrom_ok_audio_info_",lastRow:null,lastRowCandidate:null,timer:0,jsessionId:"",clientHashV:"",scriptNode:null,cache:{},ajaxTimer:{},appendDownloadMobileMusic:function(e){var t=O.a.create("a",{style:{position:"absolute",top:"-6px",left:"16px"},append:[c.svg.getSvg("download","#f1bc7f",14,14)],on:["click",function(){var t=Object(d.a)(l.a.mark((function t(n){var o=this;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),n.stopPropagation(),E.a.createLinkExtractor("ok-music").extractLinks({element:e}).then((function(e){c.download(e[0].filename,e[0].url)})).catch((function(e){T.error("appendDownloadMobileMusic. click download error",e),o.style.opacity=.3}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()]}),n=e.querySelector(".music_track_aux");n&&n.appendChild(t)},showRowElements:function(e,t,n){if(e){var o=e.querySelectorAll("div.savefrom_ok_download");o=e.querySelectorAll("div.savefrom_ok_download");for(var a=0;a<o.length;a++)o[a].style.display=t?"":"none"}},getNodeTrackId:function(e){var t=e.getAttribute("data-query");if(t)try{if((t=JSON.parse(t))&&t.trackId)return t.trackId}catch(e){return null}var n=e.querySelector("span.track_play[onclick]");if(n){var o=/(?:playMediatopic|playFeedTrack)\(['"]?(\d+)['"]?/.exec(n.getAttribute("onclick"));return o&&o[1]}return e.dataset.trackId?e.dataset.trackId:null},getTrackId:function(e){var t=H.getNodeTrackId(e);if(t)return(o={})[t]=e,o;var n=e.id;if(n){var o,a=n.indexOf("#");if(-1!==a&&(n=n.substr(a+1)),(t=c.getMatchFirst(n,/^\w+_(\d+)$/i))||-1!==n.indexOf("GROUP_FEED")&&(t=n.substr(n.lastIndexOf("_")+1)),t)return(o={})[t]=e,o}return null},showRowLinks:function(e){var t=H.getTrackId(e);for(var n in t)if(H.handleRow(n,t[n]))return!0;return!1},disable:function(){H.lastRowCandidate=null,H.lastRow=null;for(var e,t=document.querySelectorAll(".savefrom_ok_download"),n=0;e=t[n];n++)e.parentNode.removeChild(e)},getJsSessionId:function(){return("m.ok.ru"===location.host?function(){for(var e=Array.from(document.querySelectorAll("script")),t=0;t<e.length;t++)if(e[t].textContent){var n=e[t].textContent.match(/"jsid":"(.*?)"/);if(n&&n[1])return Promise.resolve(n[1])}return Promise.resolve(void 0)}:function(){return new Promise((function(e,t){var n=location.protocol+"//"+location.host+"/web-api/music/conf";Object(w.a)({type:"POST",url:n,data:"_",json:!0,localXHR:!0},(function(n,o,a){!n&&a&&a.sid?e(a.sid):t(new Error("Get jsSessionId error!"))}))}))})().then((function(e){H.jsessionId=e}),(function(e){T.debug("getJsSessionId error",e)}))},getLink:function(e){e&&H.jsessionId&&(H.ajaxTimer[e]=window.setTimeout((function(){delete H.ajaxTimer[e],H.deleteLink(e)}),3e4),u.a.sendMessage({action:"getOdnoklassnikiAudioLinks",url:location.href,trackId:e,jsessionId:H.jsessionId},(function(e){H.setLink(e.trackId,e.data)})))},onMouseOver:function(){if(H.jsessionId){var e=this;e&&(H.lastRowCandidate=e,clearTimeout(H.timer),H.lastRow!==e&&(H.timer=window.setTimeout((function(){H.showRowElements(H.lastRow,!1),H.lastRow=e,H.lastRowCandidate=null,H.showRowElements(H.lastRow,!0)}),250)))}},onMouseOut:function(){var e=this;(H.lastRow&&H.lastRow.contains(e)||H.lastRowCandidate&&H.lastRowCandidate.contains(e))&&(clearTimeout(H.timer),H.timer=window.setTimeout((function(){H.showRowElements(H.lastRow,!1),H.lastRow=null,H.lastRowCandidate=null}),1e3)),e=null},onNewMouseEnter:function(e){var t=this;if(!this.querySelector(".".concat("savefrom_ok_download"))){var n=Object(L.a)(this);if(document.querySelector(n)!==this)throw new Error("Node path is incorrect");return H.getNodeTrack(n).then((function(e){"WM-TRACK2"===t.tagName?H.insertButtonOnOver(t,e):H.insertButton(t,e)}))}},insertButtonOnOver:function(e,t){var n=this,o=new(Object(I.a)())((function(o){if(!S)return a();for(var r=null,i=null,s=0;r=o.shift();)if("childList"===r.type&&r.target===e)for(s=0,r.addedNodes;i=r.addedNodes[s];s++)if("SLOT"===i.tagName&&"controls"===i.name){e.querySelector(".".concat("savefrom_ok_download"))||(n.insertButton(e,t),a());break}})),a=function(){o.disconnect()};o.observe(e,{childList:!0})},insertButton:function(e,t){var n=["sf-audio","savefrom_ok_download"],o=null;if("WM-TRACK"===e.tagName?o=e.querySelector(".wm-track_controls"):"WM-TRACK2"===e.tagName&&(n.push("sf-audio-2"),o=e.querySelector('slot[name="controls"]')),e.classList.contains("track-with-cover")&&(o=e.querySelector('[data-l="t,addTrack"]')),!o){var a=e.querySelector('slot[name="controls"], wm-duration');o=document.createElement("div"),e.insertBefore(o,a)}var r=O.a.create("a",{href:"#",data:{state:"idle",trackId:t.id},class:n,style:{display:"none",position:"relative",width:"16px",height:"16px",verticalAlign:"middle"},on:[["mouseenter",H.handlePreload],["click",H.handleClickNewButton],["mouseenter",function(){J.tooltip.textContent=H.getNewButtonTooltipLabel(this),J.show(this)}],["mouseleave",function(){J.hide()}],["sf-state-change",function(){J.tooltip.textContent=H.getNewButtonTooltipLabel(this),J.updatePos(this)}],["mouseover",function(e){if(D){if(!e.altKey&&!e.ctrlKey)return e.preventDefault(),void Object(A.b)(r,{defaultWidth:400,defaultHeight:60});Object(A.a)(r,{defaultWidth:400,defaultHeight:60})}}]]});Object(q.a)({category:"append",subcategory:"ok",event:"b"}),o.appendChild(r)},getNewButtonTooltipLabel:function(e){switch(e.dataset.state){case"pending":return"...";case"done":var t=JSON.parse(e.dataset.data),n=t.duration,o=t.size,a="";if(o){var r=c.sizeHuman(o,2);if(n){var i=Math.floor(o/n/125)+" "+u.a.i18n.getMessage("kbps");a="".concat(r," ~ ").concat(i)}else a="".concat(r)}else a=u.a.i18n.getMessage("getFileSizeFailTitle");return a;case"error":return u.a.i18n.getMessage("noLinksFound");default:return""}},handlePreload:function(e){var t=this,n=e.target.closest("wm-track")||e.target.closest("wm-track2");return E.a.createLinkExtractor("ok-music").extractLinks({element:n}).then((function(n){t.href=n[0].url,t.download=n[0].filename,t.dataset.data=JSON.stringify({duration:n[0].duration,size:n[0].size}),t.dataset.state="done",t.dispatchEvent(new CustomEvent("sf-state-change")),t.dataset.downloadOnReady>0&&H.handleClickNewButton.call(t,e)})).catch((function(e){T.error("LinkExtractor error",e),t.dataset.state="error",t.dispatchEvent(new CustomEvent("sf-state-change"))}))},handleClickNewButton:function(e){e.stopPropagation(),"done"!==this.dataset.state?(e.preventDefault(),"1"!==this.dataset.downloadOnReady&&(this.dataset.downloadOnReady="1")):c.downloadOnClick(e)},getNodeTrack:function(e){return Object(M.a)([e],'function(nodePath){var el=document.querySelector(nodePath);if(el&&el.props&&el.props.track){return el.props.track}if(el&&el.model&&el.model._data.get("track")){return el.model._data.get("track")}throw new Error("Track information not found")}')},getNodePath:function(e){for(var t=[];e.parentNode&&1===e.parentNode.nodeType;){var n="",o=[].slice.call(e.parentNode.childNodes);o.length>1&&(n=":nth-child(".concat(o.indexOf(e)+1,")")),t.unshift("".concat(e.tagName).concat(n)),e=e.parentNode}return t.join(">")},handleRow:function(e,t){if(!e||!t)return!1;var n=t;n.style.position="relative";var o=t.querySelector(".m_c_duration, .m_portal_duration"),a=document.createElement("div");a.className="savefrom_ok_download";var r=40,i=document.getElementById("mmpcw");i&&i.contains(t)&&(r=65),c.setStyle(a,{color:"#fff",background:"#46aa19",border:"1px solid #337d12",borderRadius:"3px",padding:"1px 5px",position:"absolute",right:r+"px",top:"50%",lineHeight:"15px",fontSize:"12px",opacity:0,zIndex:9999,cursor:"pointer"}),a.addEventListener("click",H.onBoxClick,!1),a.addEventListener("mousedown",(function(e){e.stopPropagation()}),!1);var s=H.getTitle(e,t),d=function(e,t,n){null==n&&(n=!0);var o=document.createElement("a");return o.href=e,o.className="savefrom_ok_download",o.textContent=t,n&&o.setAttribute("target","_blank"),o}("#","...");d.id=H.downloadIdPrefix+e,d.title=u.a.i18n.getMessage("downloadTitle"),o&&d.setAttribute("data-savefrom-helper-duration",H.secondsFromDurationNode(o)),s&&(s+=".mp3",d.setAttribute("download",_.a.modify(s))),c.setStyle(d,{color:"#fff",fontWeight:"normal"}),d.addEventListener("click",H.onDownloadLinkClick,!1),a.appendChild(d),n.appendChild(a),H.cache[e]?H.setLinkFromCache(e,d):H.getLink(e),a.style.marginTop="-"+a.offsetHeight/2+"px",a.style.opacity="1";var l=document.createElement("span");return l.textContent=String.fromCharCode(215),l.title=u.a.i18n.getMessage("close"),c.setStyle(l,{color:"#fff",fontFamily:"Tahoma,Helvetica,sans-serif",fontSize:"15px",marginLeft:"7px",opacity:".7",cursor:"pointer"}),l.addEventListener("click",H.onCloseBtnClick,!1),a.appendChild(l),!0},onBoxClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.querySelector("a.savefrom_ok_download");return t?(x.a.trigger(t,"click",{cancelable:!0}),!1):(this.style.display="none",!1)},onDownloadLinkClick:function(e){return 2!=e.button&&(e.stopPropagation(),"#"==this.href?(e.preventDefault(),!1):(c.downloadOnClick(e),!1))},onCloseBtnClick:function(e){if(2==e.button)return!0;e.preventDefault(),e.stopPropagation();var t=Object(b.a)(this,".savefrom_ok_download");return t&&(t.style.display="none"),!1},deleteLink:function(e,t){if(!t&&e&&(t=document.getElementById(H.downloadIdPrefix+e)),t){var n=t.parentNode;n&&n.parentNode.removeChild(n)}},getHash:function(e,t){t||(t=[4,3,5,6,1,2,8,7,2,9,3,5,7,1,4,8,8,3,4,3,1,7,3,5,9,8,1,4,3,7,2,8]);for(var n=[],o=0;o<e.length;o++)n.push(parseInt("0x0"+e.charAt(o)));var a=[];(e=(e=n).slice(0))[32]=e[31];var r=0;for(o=32;o-- >0;)r+=e[o];for(var i=0;i<32;i++)a[i]=Math.abs(r-e[i+1]*e[i]*t[i]);return a.join("")},setLinkFromCache:function(e,t){if(!H.cache[e])return!1;if(t||(t=document.getElementById(H.downloadIdPrefix+e)),t){t.href=H.cache[e].url,t.textContent="",H.cache[e].downloadAttr&&t.setAttribute("download",H.cache[e].downloadAttr);var n=O.a.create(c.svg.getSvg("download","#ffffff"),{style:{display:"inline-block",width:"16px",height:"16px",verticalAlign:"middle",opacity:"0.9"}});t.appendChild(n);var o=document.createTextNode(H.cache[e].info);return t.nextSibling?t.parentNode.insertBefore(o,t.nextSibling):t.parentNode.appendChild(o),!0}},getClientHash:function(e){var t;return Promise.resolve((t=n(77),function(e,t){for(var n,o=[4,3,5,6,1,2,8,7,2,9,3,5,7,1,4,8,8,3,4,3,1,7,3,5,9,8,1,4,3,7,2,8],a=t(/md5=(\w*)/g.exec(e)[1]+"secret"),r=a.length,i="",s=0,d=0;d<r;d++)s+=parseInt(a[d],16);for(var c=0;c<r;c++){var l=parseInt(a[c],16);n=c===r-1?l:parseInt(a[c+1],16),i+=Math.abs(s-l*n*o[c])}return i}(e,(function(e){return t(e).toString()}))))},setLink:function(e,t,n){if(e){clearTimeout(H.ajaxTimer[e]);var o=document.getElementById(H.downloadIdPrefix+e);if(o&&!H.setLinkFromCache(e,o)){if(!t||!t.play)return H.deleteLink(e,o),void(o.textContent="?");if(void 0===n)return this.getClientHash(t.play).then((function(n){H.setLink(e,t,n)}),(function(t){H.deleteLink(e,o)}));var a=t.track&&t.track.size||-1;H.cache[e]={},H.cache[e].url=t.play+(n?"&clientHash="+n:"");var r=" ("+c.sizeHuman(a,2),i=o.getAttribute("data-savefrom-helper-duration");if(t.track&&(t.track.duration&&(i=t.track.duration),t.track.ensemble&&t.track.name)){var s=t.track.ensemble+" - "+t.track.name;H.cache[e].title=s,H.cache[e].downloadAttr=_.a.modify(s+".mp3")}if(a&&a>0&&i){if(i=parseInt(i),isNaN(i))return void delete H.cache[e];r+=" ~ "+(Math.floor(a/i/125)+" "+u.a.i18n.getMessage("kbps"))}r+=")",H.cache[e].info=r,H.setLinkFromCache(e,o)}}},getTitle:function(e,t){if(!e||!t)return"";var n="",o=t.querySelector(".m_c_artist, .mus-tr_artist, .m_portal_c_artist"),a=t.querySelector(".m_track_source, .mus-tr_song, .m_portla_track_name");return o&&(o=o.textContent)&&(n+=o.trim()),a&&(a=a.textContent)&&(n&&(n+=" - "),n+=a.trim()),n?n.replace(/\<a\s+[^\>]+\>/gi,"").replace(/\<\/a\>/gi,""):""},secondsFromDurationNode:function(e){if(!e)return 0;var t=e.textContent;if(!t)return 0;var n=t.match(/^(?:\s*(\d+)\s*\:)?\s*(\d+)\s*\:\s*(\d+)/);return n&&n.length>3?(n[1]||(n[1]=0),3600*parseInt(n[1])+60*parseInt(n[2])+parseInt(n[3])):0},getPlaylistName:function(e){if(e!==document){var t=e.querySelector(".mus_h2_tx");if(t)return _.a.modify(t.textContent)||void 0}},getNewPlaylistName:function(e){if(e!==document){var t=e.querySelector(".wm-list-description_header");if(t)return _.a.modify(t.textContent)||void 0}},elIsHidden:function(e){return null===e.offsetParent},getLayer:function(){var e=document.querySelector("#mmpcw");if(e&&!e.classList.contains("__hidden")&&(e=e.querySelector('div.m_c_s[aria-hidden="false"]'))&&!H.elIsHidden(e))return e},getNewLayer:function(){var e=document.querySelector("#music_layer wm-collection-section");if(e||(e=document.querySelector("#music_layer")),!e||!H.elIsHidden(e))return e},getPopup:function(e,t,n){var o,a=c.playlist.getInfoPopupTemplate();O.a.create(a.textContainer,{append:[e?O.a.create("p",{text:e,style:{color:"#0D0D0D",fontSize:"20px",marginBottom:"11px",marginTop:"13px"}}):void 0,o=O.a.create("p",{text:"",style:{color:"#868686",fontSize:"14px",lineHeight:"24px"}})]});var r=c.popupDiv(a.body,"sf_progress_popup",void 0,void 0,n),i=function e(n){e.state!==n&&(e.state=n,a.buttonContainer.style.display="none",o.style.display="none",u.a.sendMessage({action:"getWarningIcon",type:t,color:"#77D1FA"},(function(e){a.icon.style.backgroundImage="url("+e+")"})),"progress"===n&&(o.style.display="block"),"error"===n&&(u.a.sendMessage({action:"getWarningIcon",type:t,color:"#AAAAAA"},(function(e){a.icon.style.backgroundImage="url("+e+")"})),o.style.display="block"))};return{onPrepare:function(e){i("progress"),o.textContent=e},onProgress:function(e,t){o.textContent=u.a.i18n.getMessage("vkFoundFiles").replace("%d",e)+" "+u.a.i18n.getMessage("vkFoundOf")+" "+t},onReady:function(){x.a.trigger(r,"kill")},onError:function(e){i("error"),o.textContent=e}}},getAudioLinksViaAPI:function(e,t,n){var o=!1,a=[],r=e.length;return function i(){if(!o){var s=e.splice(0,10);if(0===s.length)return n(a);u.a.sendMessage({action:"getOkAudioListLinks",trackIdArr:s,jsessionId:H.jsessionId},(function(n){var o=Promise.resolve();Array.isArray(n)&&n.forEach((function(e){o=o.then((function(){if("string"==typeof e.play&&"object"==typeof e.track){var t,n=e.play;return e.track.name&&(t=e.track.name),e.track.ensemble&&(t=e.track.ensemble+(t?" - "+t:"")),t||(t="noname"),H.getClientHash(n).then((function(o){n+="&clientHash="+o,a.push({url:n,duration:e.track.duration||0,title:t,filename:_.a.modify(t)+".mp3"})}))}})).catch((function(t){T.debug("process item error",e,t)}))})),o.then((function(){t(r-e.length,r),i()}))}))}}(),{abort:function(){o=!0}}},getAudioListLinksPopup:function(e,t,n){var o,a=this.getPopup(t,"audio",(function(){o&&o.abort()}));a.onPrepare(u.a.i18n.getMessage("download")+" ..."),o=this.getAudioLinksViaAPI(e,a.onProgress,(function(e){0!==e.length?(a.onReady(),n(e)):a.onError(u.a.i18n.getMessage("vkMp3LinksNotFound"))}))},getAudioLinksIds:function(e){return Promise.resolve().then((function(){for(var t,n=e.querySelectorAll([".m_portal_track",".m_c_tr",".mus-tr_i"]),o=[],a=0;t=n[a];a++){var r=H.getTrackId(t);for(var i in r)o.push(i)}return o}))},getNewAudioLinksIds:function(e){var t=Object(L.a)(e);if(!t||document.querySelector(t)===e)return Object(M.a)([t],'function(nodePath){var result=null;try{var container=nodePath===""?document:document.querySelector(nodePath);var ids=[].slice.call(container.querySelectorAll(["wm-track","wm-track2"])).reduce(function(result,node){try{var getTrack=function getTrack(){if(node&&node.props&&node.props.track){return node.props.track}if(node&&node.model&&node.model._data.get("track")){return node.model._data.get("track")}throw new Error("getNewAudioLinksIds")};var track=getTrack();if(track){result.push(track.id)}}catch(err){// console.error(\'getNewAudioLinksIds error\', err);\n}return result},[]);result={result:ids}}catch(err){result={error:{message:err.message,stack:err.stack}}}if(result.error){throw new Error(result.error.message)}else{return result.result}}')},getAudioFromWall:function(e){return Object(d.a)(l.a.mark((function t(){var n,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.querySelector(".media-layer.__active"),o=(e=n||e).querySelectorAll(".track-with-cover_cnt"),t.abrupt("return",Array.from(o).map((function(e){return e.closest(".track-with-cover").dataset.trackId})));case 4:case"end":return t.stop()}}),t)})))()},getAudioLinks:function(e,t,n){var o=this;return Promise.all([this.getAudioLinksIds(e),this.getNewAudioLinksIds(e),this.getAudioFromWall(e)]).then((function(e){var t;return(t=[]).concat.apply(t,Object(s.a)(e)).filter((function(e,t,n){return n.indexOf(e)===t}))})).then((function(e){o.getAudioListLinksPopup(e,t,n)}))},downloadMP3Files:function(){var e=H.getLayer()||H.getNewLayer()||document,t=H.getPlaylistName(e)||H.getNewPlaylistName(e);H.getAudioLinks(e,t,(function(e){c.downloadList.showBeforeDownloadPopup(e,{type:"audio",folderName:t})}))},showListOfAudioFiles:function(e){var t=H.getLayer()||H.getNewLayer()||document,n=H.getPlaylistName(t)||H.getNewPlaylistName(t);H.getAudioLinks(t,n,(function(t){t.length?e?c.playlist.popupPlaylist(t,n,!0):c.playlist.popupFilelist(t):alert(u.a.i18n.getMessage("vkMp3LinksNotFound"))}))}},U={requestMobileToken:function(e,t){var n=null;e.links.some((function(e){var t=e.url.match(/\/\/([^/]+)/);if(t=t&&t[1])return n=t,!0}));var o=function(e){return new Promise((function(t){var n=new XMLHttpRequest;n.open("POST",location.protocol+"//"+e+"/usr_login",!1),n.withCredentials=!0,n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){try{var e=JSON.parse(n.responseText);if(!e.vtkn||!e.ttl)return t();t({ttl:e.ttl,vtkn:e.vtkn})}catch(e){}},n.send()}))};Object(M.a)((function(){var e=document.cookie&&document.cookie.match(/vdsig=([^;]+);/);if(e&&e[1])return e[1]})).then((function(a){if(a)return e.vtkn=a,t(e);var r=function(n){var o=n.ttl,a=n.vtkn;o&&a&&(F.videoToken={ttl:Date.now()+1e3*o,vtkn:a},e.vtkn=a,t(e))};u.a.isChrome||u.a.isFirefox?Object(M.a)([n],o).then(r):o(n).then(r)}))},getMobileToken:function(e,t){if(e.vtkn)return t(e);var n=F.videoToken;return n&&n.expire>Date.now()?(e.vtkn=n.vtkn,t(e)):U.requestMobileToken(e,t)},wrapMobileLinks:function(e,t){U.getMobileToken(e,(function(e){if(!e||!e.vtkn)return t();e.action="getOkViaMobileWrapped",e.links.forEach((function(t){var n=/\?/.test(t.url)?"&":"?";t.url+=n+"vdsig="+e.vtkn})),t(e)}))},prepareResponse:function(e,t){var n=function(){t(u.a.i18n.getMessage("noLinksFound"))};if(!e||!e.links)return n();if(!p.showUmmyItem&&"getRutubeLinks"===e.action)return n();if("getOkViaMobile"===e.action)return U.wrapMobileLinks(e,(function(e){if(!e)return n();U.prepareResponse(e,t)}));var o=null;"getYoutubeLinks"===e.action?o="youtube":"getVimeoLinks"===e.action?o="vimeo":"getDailymotionLinks"===e.action?o="dailymotion":"getRutubeLinks"===e.action&&(o="rutube");var a=null;return a=o?c.popupMenu.prepareLinks[o](e.links,e.title):z.prepareLinks(e.links,e.title),t(a)},matchOpenGraph:function(e){if(e&&e.movie&&e.movie.contentId){var t=e.movie.contentId;if(-1!==t.indexOf("rutube.")&&p.showUmmyItem)return{action:"getRutubeLinks",links:[t]};if(-1!==t.indexOf("pladform")){var n=Object(h.a)(t);return{action:"getPladformVideo",extVideoId:{playerId:n.pl,videoId:n.videoid}}}var o=c.embedDownloader.checkUrl(t);if(o)return o;var a=e.movie.poster;if("string"==typeof a){var r=(Object(h.a)(a).url||a).match(/ytimg\.com\/vi\/([^\/]+)\//);if(r=r&&r[1])return{action:"getYoutubeLinks",extVideoId:r}}}},switchMetadataProvider:function(e){if(e&&e.provider&&e.movie)switch(e.provider){case"USER_YOUTUBE":if(e.movie.contentId)return{request:{action:"getYoutubeLinks",extVideoId:e.movie.contentId}};break;case"OPEN_GRAPH":var t=this.matchOpenGraph(e);if(t)return{request:t};break;case"LIVE_TV_APP":case"SLIDE_SHOW":case"LIVE_TV_ODKL":case"UPLOADED_ODKL":case"UPLOADED_ATTACHMENT":case"UPLOADED":case"PARTNER":case"YKL":if(e.videos&&e.movie.title)return{request:{action:"wrapMobileLinks",title:e.movie.title,links:e.videos}}}},getPlayerMetadata:function(e,t,n,o){var a={cmd:"videoPlayerMetadata",mid:e,rnd:Date.now()};o&&(a.mtId=t),Object(w.a)({method:"POST",url:location.protocol+"//"+location.host+"/dk?"+R.stringify(a),json:!0,localXHR:!0},(function(a,r,i){return a?!o&&t?void U.getPlayerMetadata(e,t,n,1):n():n(i)}))},getEmbed:function(e,t){var n=Object(h.a)(e);if(!n.id||!n.sig)return t();var o="http://cdn-ok.com/video/get/?"+R.stringify({id:n.id,format:1,sig:n.sig,sig2:"oldRotator"});u.a.sendMessage({action:"getData",url:o},(function(e){return e&&Object(g.a)(e,[/"sourceType":/,/"sourceId":/]).some((function(e){if("youtube"===e.sourceType&&e.sourceId)return t({request:{action:"getYoutubeLinks",extVideoId:e.sourceId}}),!0}))?void 0:t()}))},readMetadata:function(e,t,n){if(e.movie&&/cdn-ok\.com\/embed/.test(e.movie.contentId))return this.getEmbed(e.movie.contentId,(function(e){if(!e||!e.request)return t();u.a.sendMessage(e.request,(function(e){U.prepareResponse(e,t)}))}));if(!n&&e.movie&&e.movie.movieId){var o=e.movie.link&&Object(h.a)(e.movie.link,{sep:"&amp;"})["st.vpl.sid"];return this.getPlayerMetadata(e.movie.movieId,o,(function(n){U.readMetadata(n||e,t,1)}))}var a=this.switchMetadataProvider(e);return a?a.links?t(a.links):void(a.request?"getRutubeLinks"===a.request.action?U.prepareResponse(a.request,t):"wrapMobileLinks"===a.request.action?U.wrapMobileLinks(a.request,(function(e){U.prepareResponse(e,(function(e){t(e,1)}))})):u.a.sendMessage(a.request,(function(e){U.prepareResponse(e,t)})):t()):t()},prepareVideoUrl:function(e,t){var n=e.split("?"),o=t.split("?"),a=Object(i.a)(o,2),r=a[0],s=a[1];if(!n[1]||!s)return t;if(n=new URLSearchParams(n[1]),s=new URLSearchParams(s),!n.has("type"))return t;var d=n.get("type");return s.has("st.mq")&&s.set("st.mq",d),s.has("st.hls")&&s.set("st.hls","off"),r+"?"+s.toString()},getMobileVideoSrc:function(e){return e&&e.dataMobile&&e.dataMobile.videoSrc?Promise.resolve(e.dataMobile.videoSrc):e&&e.movie&&e.movie.id?Object(j.a)({action:"getOkVideoUrlFromMobile",videoUrl:location.href,videoId:e.movie.id}):Promise.resolve(void 0)},loadLinks:function(e,n,o){var a=F.linkCache,r=JSON.stringify(e),i=a[r];if(i)return n.update(i);var s=function(e,i){var s=function(){n.update(u.a.i18n.getMessage("noLinksFound"))};return e?e.hlsManifestUrl?E.a.createLinkExtractor("ok-video").extractLinks({element:o,initData:t}).then((function(e){n.update(e)})).catch((function(e){s(),T.error("hls error",e)})):void U.readMetadata(e,(function(e,t){if(!e)return s();Array.isArray(e)&&!e.length&&(t=1),t||(a[r]=e),n.update(e)}),i):s()};e.metadata?s(e.metadata):e.request?"getOkMetadata"===e.request.action?u.a.sendMessage(e.request,s):"getPlayerMetadata"===e.request.action?this.getPlayerMetadata(e.request.extVideoId,e.request.sid,(function(e){s(e,1)})):"getRutubeLinks"===e.request.action?U.prepareResponse(e.request,(function(e){n.update(e)})):u.a.sendMessage(e.request,(function(e){U.prepareResponse(e,(function(e){n.update(e)}))})):n.update(u.a.i18n.getMessage("noLinksFound"))},appendLinkUnderVideo:function(e,t,n){Object(q.a)({category:"append",subcategory:"ok",event:"b"});var o=e.querySelector(".vp-layer-info_cnt");if(o){var a=o.querySelector(".savefrom_ok_download"),r=O.a.create("span",{className:"savefrom_ok_download",style:{marginLeft:"12px"},on:[["click",function(e){e.stopPropagation()}],["mousedown",function(e){e.stopPropagation()}],["keydown",function(e){e.stopPropagation()}]],append:[O.a.create("a",{href:"#",text:u.a.i18n.getMessage("download"),on:["click",function(o){if(o.preventDefault(),x.a.onRemoveEvent(r,F.hideMenu),F.contextMenu&&F.contextMenu.isShow){if(F.contextMenu.button===this)return void F.hideMenu();F.hideMenu()}var a=F.contextMenu=c.popupMenu.quickInsert(this,u.a.i18n.getMessage("download")+"...","sf-single-video-menu",{parent:e});U.loadLinks(t,a,n)}]})]});a&&a.parentNode?(a.parentNode.replaceChild(r,a),a=null):o.appendChild(r)}},appendDownloadMobileVideo:function(e){var t={float:"right",display:"flex",alignItems:"center",width:"fit-content"},n=e.querySelector(".widget-list_infos"),o=e.querySelector("[data-video]");if(n&&o){n.querySelector(".widget-list_actors, .ic")||(t.position="absolute",t.top="-7px",t.right="0");var a=U.createMobileDownloadContainer(o,{containerStyle:t,menuClass:"sf-mobile-video-menu"});n.appendChild(a)}},createMobileDownloadContainer:function(e,t){var n=t.containerStyle,o=t.menuClass,a=O.a.create("div",{style:n||{},append:[c.svg.getSvg("download","#f1bc7f",14,14),O.a.create("a",{href:"#",text:u.a.i18n.getMessage("download"),style:{marginLeft:"4px"}})],on:["click",function(t){t.preventDefault(),t.stopPropagation(),F.contextMenu=c.popupMenu.quickInsert(this,u.a.i18n.getMessage("download")+" ...",o,{parent:a||t.target}),U.getMobilePlayerOptions(e).then((function(t){if(!t)return F.contextMenu.update(u.a.i18n.getMessage("noLinksFound"));U.loadLinks(t,F.contextMenu,e)}))}]});return a},getPlayerOptions:function(e){var t=Object(b.a)(e,"[data-player-element-id][data-options]"),n=t&&t.dataset.options;if(n){try{n=JSON.parse(n)}catch(e){}var o=n.flashvars;if(o){if(o.metadata){var a=null;try{a=JSON.parse(o.metadata)}catch(e){}if(a)return{metadata:a}}if(o.metadataUrl)return{request:{action:"getOkMetadata",url:decodeURIComponent(o.metadataUrl)}};var r=n.url;if(r){var i=c.embedDownloader.checkUrl(r);if(i)return{request:i};if(-1!==r.indexOf("rutube."))return{request:{action:"getRutubeLinks",links:[r]}}}}}},getMobilePlayerOptions:function(e){return Object(d.a)(l.a.mark((function t(){var n,o,a,r,i,s,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{n=JSON.parse(e.dataset.video)}catch(e){}if(n&&n.movieId?(o=n.movieId).indexOf("_")&&(o=o.split("_")[0]):(a=new URLSearchParams(location.search),o=a.get("st.discId")),o){t.next=5;break}return T.error("getMobilePlayerOptions. video id not found"),t.abrupt("return");case 5:return t.next=7,Object(j.a)({action:"okRequestVideoPage",videoId:o});case 7:if(r=t.sent){t.next=11;break}return T.error("getMobilePlayerOptions. videoPage fetch failed"),t.abrupt("return");case 11:if(i=Object(N.a)(r,""),s=i.querySelector(".vp_video .vid-card_cnt")){t.next=16;break}return T.error("getMobilePlayerOptions. Video dataset not found"),t.abrupt("return");case 16:return(d=U.getPlayerOptions(s)).metadata?d.metadata.dataMobile=n:d.metadata={dataMobile:n},t.abrupt("return",d);case 19:case"end":return t.stop()}}),t)})))()},catchPopup:function(){var e=null;this.lastWaitEl&&this.lastWaitEl.abort(),this.lastWaitEl=this.waitEl((function(){if(e=document.querySelector(".vp_video .vid-card_cnt"))return e}),(function(){var t=Object(b.a)(e,".vp_video");if(t){var n=U.getPlayerOptions(e);n&&U.appendLinkUnderVideo(t.parentNode,n,e)}}))},rmBtn:function(){for(var e,t=document.querySelectorAll(".savefrom_ok_download"),n=0;e=t[n];n++)e.parentNode.removeChild(e)},lastWaitEl:null,waitEl:function(e,t,n){var o,a=Object.assign({abort:function(){clearInterval(a.timeout),a.isAborted=!0}},{delay:500,repeat:12,isAborted:!1,timeout:null},n);return(o=e())?(t(o),a):(function n(){a.repeat--,a.timeout=setTimeout((function(){if(!a.isAborted)return(o=e())?t(o):void(!a.isAborted&&a.repeat&&n())}),a.delay)}(),a)}},z={btnClassName:"sf-feed-dl-btn",style:void 0,thumbClassName:"vid-card_img",prepareLinks:function(e,t){if(!e||!e.length)return u.a.i18n.getMessage("noLinksFound");if("string"==typeof e)return e;t=t||"";for(var n,o,a,r,i=[],s=0,d=e.length;s<d;s++){var l=e[s];if("object"==typeof l&&l.url){r=l.url;var f=l.ext;f||(f="MP4",-1!==l.url.indexOf(".mp4")&&(f="MP4"),-1!==r.indexOf(".flv")&&(f="FLV"),-1!==l.url.indexOf(".mov")&&(f="MOV"),-1!==l.url.indexOf(".mpg")&&(f="MPG")),a=(f=f.toLowerCase()).toUpperCase(),o=l.subname||l.quality||l.name||f}else{f="MP4",-1!==(r=l).indexOf(".mp4")&&(f="MP4"),-1!==r.indexOf(".flv")&&(f="FLV"),-1!==r.indexOf(".mov")&&(f="MOV"),-1!==r.indexOf(".mpg")&&(f="MPG"),a=(f=f.toLowerCase()).toUpperCase(),o=f;var p=c.getMatchFirst(e[s],/\.(\d+)\.mp4/i);p&&(o=p)}var v=["mobile","lowest","low","sd","hd","full","quad","ultra"].indexOf(o);-1!==v&&(o=[144,240,360,480,720,1080,1440,"4K"][v]),n={href:r,title:l.title?l.title:t,ext:f,format:a,quality:o,forceDownload:!0},i.push(n)}return i},getPosterData:function(e){var t=Object(b.a)(e,"[hrefattrs]"),n=t&&t.getAttribute("hrefattrs");if(n){var o=Object(h.a)(n,{params:!0}),a=o["st.vpl.sid"],r=o["st.vpl.id"];if(!r){var i=Object(b.a)(e,"[data-id]");if((r=i&&i.dataset.id)&&"c"===r[0])return}if(r&&"OK_"===r.substr(0,3)&&(r=c.getMatchFirst(r,/OK_\d+_(\d+)/)),r)return{request:{sid:a,action:"getPlayerMetadata",extVideoId:r}}}},onBtnClick:function(e,t,n){e.preventDefault(),e.stopPropagation();var o=JSON.parse(t.dataset.sfContext);if(x.a.onRemoveEvent(t,F.hideMenu),F.contextMenu&&F.contextMenu.isShow){if(F.contextMenu.button===t)return void F.hideMenu();F.hideMenu()}var a=document.querySelector("#mtLayer.__active #mtLayerMain > div");a||(a=document.getElementById("vv_content")),a||Object(y.a)(t,".js-messages-list "+t.tagName)&&(a=Object(v.a)(t,"js-messages-list"))&&!a.offsetParent&&(a=null),!a&&Object(y.a)(t,"#mainContent "+t.tagName)&&(a=Object(b.a)(t,"#mainContent"));var r=F.contextMenu=c.popupMenu.quickInsert(t,u.a.i18n.getMessage("download")+" ...","sf-popupMenu",{parent:a||void 0});Object(q.a)({category:"download",subcategory:"ok",event:"video"}),U.loadLinks(o,r,n)},onImgOver:function(e){var t=Object(y.a)(this,".mdialog_chat_window .d_comment_text_w "+this.tagName),n=null;if((t?n=Object(v.a)(this,"d_comment_text_w"):Object(y.a)(this,".video-card > .video-card_img-w "+this.tagName)?n=Object(v.a)(this,"video-card_img-w"):this.classList.contains("vid-card_cnt")?n=this:Object(y.a)(this,".vid-card_cnt "+this.tagName)&&(n=Object(v.a)(this,"vid-card_cnt")),n)&&(!n.getElementsByClassName(z.btnClassName).length&&!!!n.querySelector(".vid-card_live.__active"))){var o=Object(y.a)(this,".vid-card_img__link "+this.tagName),a=U.getPlayerOptions(this);if(a||(a=z.getPosterData(this)),a){a.isChat=t;var r={};t&&Object.assign(r,{left:"15px",top:"15px"}),o&&Object.assign(r,{backgroundColor:"#454648",borderColor:"rgb(53, 53, 53)"});var i=O.a.create("i",{class:[z.btnClassName,"sf-video-feed-bind-on-insert"],style:r,data:{sfContext:JSON.stringify(a)},title:u.a.i18n.getMessage("download")});i.appendChild(O.a.create(c.svg.getSvg("download"),{style:{width:"12px",height:"12px",margin:"4px"}})),n.appendChild(i)}}},injectStyle:function(){var e;this.style?this.style.parentNode||document.head.appendChild(this.style):(this.style=O.a.create("style",{text:Object(k.a)((e={"div > .sf-feed-dl-btn":{display:"none",border:"1px solid #F8F8F8",width:"20px",height:"20px",padding:0,position:"absolute",top:0,left:0,zIndex:1,cursor:"pointer",backgroundColor:"#F8F8F8"},"div > .sf-feed-dl-btn svg path":{fill:"#eb722e"},"div > .sf-feed-dl-btn:hover svg path":{fill:"#00B75A"},"div > .sf-feed-dl-btn:active":{outline:0,boxShadow:"inset 0 3px 5px rgba(0, 0, 0, 0.125)"},"div:hover > .sf-feed-dl-btn":{display:"block"}},Object(r.a)(e,".sf-audio.".concat("savefrom_ok_download"),{display:"none",backgroundImage:"url("+c.svg.getSrc("download","#ee8208")+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"16px",opacity:.5,marginLeft:"11px"}),Object(r.a)(e,".sf-audio.sf-audio-2.".concat("savefrom_ok_download"),{margin:"0 6px"}),Object(r.a)(e,".sf-audio.".concat("savefrom_ok_download",":hover"),{opacity:1}),Object(r.a)(e,"wm-track:hover .sf-audio",{display:"flex !important"}),Object(r.a)(e,"wm-track2:hover .sf-audio",{display:"flex !important"}),Object(r.a)(e,"#sf-mobile-video-menu",{left:"auto !important",right:"0"}),e))}),document.head.appendChild(this.style))},disable:function(){this.style&&this.style.parentNode&&this.style.parentNode.removeChild(this.style)},rmBtn:function(){for(var e,t=document.querySelectorAll(".sf-feed-dl-btn"),n=0;e=t[n];n++)e.parentNode.removeChild(e);var o=Object(m.a)("sfSkip2"),a=document.querySelectorAll("["+o+"]");for(n=0;e=a[n];n++)e.removeAttribute(o)}},W={style:null,rmCurrentPhotoBtn:function(e){for(var t,n=void 0,o=document.querySelectorAll(".sf-dl-current-photo-btn"),a=0;t=o[a];a++)e&&e.contains(t)?n=t:t.parentNode.removeChild(t);return n},addDlCurrentPhotoBtn:function(e){if(!this.rmCurrentPhotoBtn(e)){var t=F;e.appendChild(O.a.create("a",{class:"sf-dl-current-photo-btn",href:"#",title:u.a.i18n.getMessage("download"),on:["click",function(n){if(n.stopPropagation(),n.preventDefault(),t.contextMenu&&t.contextMenu.isShow&&t.contextMenu.button===this){if(t.contextMenu.button===this)return void t.hideMenu();t.hideMenu()}var o=function e(t){18!==t.keyCode&&17!==t.keyCode&&(a.hide(),document.removeEventListener("keydown",e))},a=t.contextMenu=c.popupMenu.quickInsert(this,u.a.i18n.getMessage("download")+" ...","photoDlMenu",{parent:e,onShow:function(){document.addEventListener("keydown",o)},onHide:function(){document.removeEventListener("keydown",o)}}),r=[],i=e.querySelector("img.photo-layer_img");if(i){var s=i.dataset.fsSrc||i.dataset.nfsSrc||i.src;s&&r.push({href:s,title:"photo_"+parseInt(Date.now()/1e3),quality:u.a.i18n.getMessage("download"),format:" ",ext:"jpg",forceDownload:!0,isBlank:!0,func:function(){a.hide()}})}if(i||(i=e.querySelector("div.gif[data-gifsrc]")),i){var d={webmsrc:"webm",mp4src:"mp4",gifsrc:"gif"};Object.keys(d).forEach((function(e){var t=i.dataset[e];if(t){var n=d[e];r.push({href:t,title:"gif_"+parseInt(Date.now()/1e3),quality:u.a.i18n.getMessage("download"),format:n.toUpperCase(),ext:n,forceDownload:!0,isBlank:!0,func:function(){a.hide()}})}}))}0!==r.length?a.update(r):a.update(u.a.i18n.getMessage("noLinksFound"))}],append:[O.a.create(c.svg.getSvg("download"),{style:{width:"12px",height:"12px",margin:"4px"}})]}))}},injectStyle:function(){W.style?W.style.parentNode||document.head.appendChild(W.style):(W.style=O.a.create("style",{text:Object(k.a)({"div > .sf-dl-current-photo-btn":{display:"none",border:"1px solid #F8F8F8",width:"20px",height:"20px",padding:0,position:"absolute",backgroundColor:"#F8F8F8",top:"73px",left:"90px",zIndex:100,cursor:"pointer"},"div > .sf-dl-current-photo-btn svg path":{fill:"#eb722e"},"div > .sf-dl-current-photo-btn:hover svg path":{fill:"#00B75A"},"div > .sf-dl-current-photo-btn:active":{outline:0,boxShadow:"inset 0 3px 5px rgba(0, 0, 0, 0.125)"},"div:hover > .sf-dl-current-photo-btn":{display:"block"}})}),document.head.appendChild(W.style))},addCurrentDlBtn:function(e){if("1"!==e.dataset.sfSkip2){e.dataset.sfSkip2="1";var t=e.querySelector("img.photo-layer_img");if(t)t.dataset.fsSrc||t.dataset.nfsSrc||t.src||(t=null);t||(t=e.querySelector("div.gif[data-gifsrc]")),t&&this.addDlCurrentPhotoBtn(e)}}},J=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(o.a)(this,e),this.options=t,this.tooltip=null,this.init()}return Object(a.a)(e,[{key:"init",value:function(){var e=this;this.tooltip=O.a.create("div",{class:"sf-tooltip",style:Object.assign({position:"absolute",display:"none",zIndex:9999,opacity:0,transition:"opacity 0.2s",whiteSpace:"nowrap",fontSize:"12px",color:"#111",fontFamily:"arial, verdana, sans-serif, Lucida Sans"},this.options.style),on:["mouseenter",function(t){e.hide()}]}),document.body.appendChild(this.tooltip)}},{key:"updatePos",value:function(e){var t=c.getPosition(e),n=c.getSize(this.tooltip);this.tooltip.style.top=t.top+this.options.top-n.height+"px";var o=t.left+parseInt(this.options.width/2,10)-parseInt(n.width/2,10),a=document.body.clientWidth+document.body.scrollLeft;a<o+n.width&&(o=a-n.width),this.tooltip.style.left=o+"px"}},{key:"show",value:function(e){var t=this;this.tooltip.style.display="block",setTimeout((function(){t.updatePos(e),t.tooltip.style.opacity=1}))}},{key:"hide",value:function(){this.tooltip.style.opacity=0,this.tooltip.style.display="none"}},{key:"destroy",value:function(){this.tooltip.parentNode&&(this.tooltip.parentNode.removeChild(this.tooltip),this.tooltip=null)}}]),e}())({top:-12,width:16,style:{backgroundColor:"#fff",border:"1px solid #ccc",color:"rgb(48, 48, 48)",fontSize:"12px",padding:"3px"}})}))}});