!function(A){function e(e){for(var n,o,s=e[0],i=e[1],c=e[2],l=0,d=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(A[n]=i[n]);for(u&&u(e);d.length;)d.shift()();return a.push.apply(a,c||[]),t()}function t(){for(var A,e=0;e<a.length;e++){for(var t=a[e],n=!0,s=1;s<t.length;s++){var i=t[s];0!==r[i]&&(n=!1)}n&&(a.splice(e--,1),A=o(o.s=t[0]))}return A}var n={},r={12:0},a=[];function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return A[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=A,o.c=n,o.d=function(A,e,t){o.o(A,e)||Object.defineProperty(A,e,{enumerable:!0,get:t})},o.r=function(A){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(A,"__esModule",{value:!0})},o.t=function(A,e){if(1&e&&(A=o(A)),8&e)return A;if(4&e&&"object"==typeof A&&A&&A.__esModule)return A;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:A}),2&e&&"string"!=typeof A)for(var n in A)o.d(t,n,function(e){return A[e]}.bind(null,n));return t},o.n=function(A){var e=A&&A.__esModule?function(){return A.default}:function(){return A};return o.d(e,"a",e),e},o.o=function(A,e){return Object.prototype.hasOwnProperty.call(A,e)},o.p="";var s=window.savefromContentScriptWebpackJsonp=window.savefromContentScriptWebpackJsonp||[],i=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=i;a.push([115,0]),t()}({115:function(A,e,t){"use strict";t.r(e);var n=t(14),r=t(4),a=t(5),o=t(6),s=t(22),i=t(23),c=t(13),u=t(2),l=t.n(u),d=t(0),p=t(59),f=t(16),h=t(18),y="\n  .sf--sc-btn {\n    background-image: url(".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAPklEQVR42mNgGHTgvw/DfxgexJqBiuYja8CD55NrwHxyXTCfWP/OJ0sjFgPmkxvXCWRFDy6MT3MDITw40j8Ak46HYQ4gDfUAAAAASUVORK5CYII=",");\n    background-repeat: no-repeat;\n    background-position: 50%;\n  }\n  .sf--sc-playlist {\n    background-image: url(").concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAMUlEQVR42mL8//8/A7mAiYECwILC82Uk7IzN/xmpYjPjqJ9H/UxTP1OkGQAAAP//AwDcahUV6UvyJwAAAABJRU5ErkJggg==",");\n    background-size: 50%;\n  }\n  .sf--sc-loading {\n    background-image: url(").concat("data:image/gif;base64,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",");\n    background-size: 50%;\n  }\n  .sf--sc-error {\n    background-image: url(").concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAVklEQVQoz2P4//8/A7mYgSqa0UF9ff1/GEaXG0SagYrmI2vAg+djtZkIA+bjdTYeA+YT5WcsBswnNcDmY9NIlGaoAQnYxHEFGMHQxqe5gRDGqpnuGQMALmDKhkjc9oYAAAAASUVORK5CYII=",");\n  }\n"),g=t(28),b=t(25),k=t(15),w=t(29),Q=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome");function C(A){return A.dataset.sfSongReady=1,A}var E=function(A){return!A.dataset.sfSongReady},m=function(){try{return"Tampermonkey"===GM_info.scriptHandler||"Violentmonkey"===GM_info.scriptHandler}catch(A){return!1}},M=function(){return!m()&&!(d.a.isGM&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"))},B=function(A){var e=A.url,t=A.filename;if(m()){var n=document.createElement("a");n.style.display="none",n.href=e,n.setAttribute("target","_blank"),n.download=t,document.body.appendChild(n),n.click(),n.remove()}else{var r=new CustomEvent("song.download",{detail:{downloadURL:e,filename:t}});document.dispatchEvent(r)}},v=function(A){var e=document.createElement("a");return e.target="_blank",A&&e.classList.add("sf--sc-"+A),e.classList.add("sf--sc-btn","sc-button","sc-button-small","sc-button-icon","sc-button-responsive"),e.addEventListener("mouseenter",(function(A){if(Q){if(!A.altKey&&!A.ctrlKey)return A.preventDefault(),void Object(w.b)(e,{content:d.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60});Object(w.a)(e,{content:d.a.i18n.getMessage("downloadTitle"),defaultWidth:400,defaultHeight:60})}})),Object(k.a)({category:"append",subcategory:"so",event:"b"}),e},x=function(A,e){["loading","error","playlist","default"].includes(e)&&(A.classList.remove("sf--sc-loading"),A.classList.add("sf--sc-".concat(e)))},O=t(17),I=function(){function A(){Object(a.a)(this,A),this.selector='[role="group"].sound.playlist.streamContext',this.type="added"}var e;return Object(o.a)(A,[{key:"handle",value:function(A){var e=this;A.added.filter(E).map(C).map((function(A){return e.renderDownloadButton(A)}))}},{key:"renderDownloadButton",value:function(A){var e=A.querySelector(".sc-button-group"),t=v("playlist");t.classList.add("sc-usercard-playlist"),t.addEventListener("click",this.downloadPlaylist.bind(this)),e.appendChild(t)}},{key:"downloadPlaylist",value:(e=Object(r.a)(l.a.mark((function A(e){var t,n;return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return e.stopPropagation(),t=e.target,x(t,"loading"),A.prev=3,A.next=6,O.a.createLinkExtractor("so-audio").extractLinks({element:e.target});case 6:return n=A.sent,A.next=9,Promise.all(n);case 9:A.sent.map(B),A.next=16;break;case 12:throw A.prev=12,A.t0=A.catch(3),x(t,"error"),A.t0;case 16:return A.prev=16,x(t,"default"),A.finish(16);case 19:case"end":return A.stop()}}),A,null,[[3,12,16,19]])}))),function(A){return e.apply(this,arguments)})}]),A}(),L=t(10),S=t(12),J=(Object(S.a)("userCardSingleTrack"),function(){function A(e){Object(a.a)(this,A),this.selector='[role="group"].sound.streamContext:not(.playlist)',this.type="added",this.utils=e}var e;return Object(o.a)(A,[{key:"handle",value:function(A){var e=this;A.added.filter(E).map(C).map((function(A){return e.renderDownloadButton(A)}))}},{key:"renderDownloadButton",value:function(A){var e=A.querySelector(".sc-button-group");e&&this.btnPrepare(A).then((function(A){A&&e.appendChild(A)}))}},{key:"btnPrepare",value:(e=Object(r.a)(l.a.mark((function A(e){var t,n,r,a;return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=v(),A.next=3,O.a.createLinkExtractor("so-audio").extractLinks({element:e});case 3:if(n=A.sent,r=Object(L.a)(n,1),(a=r[0]).url&&a.filename){A.next=8;break}return A.abrupt("return");case 8:return t.classList.add("sc-usercard-single-track"),t.href=a.url,t.download=a.filename,t.addEventListener("click",this.utils.downloadOnClick),A.abrupt("return",t);case 13:case"end":return A.stop()}}),A,this)}))),function(A){return e.apply(this,arguments)})}]),A}()),K=[".listenDetails .trackItem.g-flex-row.sc-type-small .sc-button-group, .chartTrack .sc-button-group",".trackItem.g-flex-row.sc-type-small.m-playable .sc-button-group"].join(","),j=function(){function A(e){Object(a.a)(this,A),this.selector=K,this.type="added",this.utils=e}var e;return Object(o.a)(A,[{key:"handle",value:function(A){var e=this;A.added.filter(E).map(C).map((function(A){return e.renderDownloadButton(A)}))}},{key:"renderDownloadButton",value:function(A){this.btnPrepare(A).then((function(e){Object(k.a)({category:"append",subcategory:"so",event:"b"}),e&&A.appendChild(e)}))}},{key:"btnPrepare",value:(e=Object(r.a)(l.a.mark((function A(e){var t,n,r,a;return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=v(),A.next=3,O.a.createLinkExtractor("so-audio").extractLinks({element:e});case 3:if(n=A.sent,r=Object(L.a)(n,1),(a=r[0]).url&&a.filename){A.next=8;break}return A.abrupt("return");case 8:return t.classList.add("sc-page-playlist"),t.href=a.url,t.download=a.filename,t.addEventListener("click",this.utils.downloadOnClick),A.abrupt("return",t);case 13:case"end":return A.stop()}}),A,this)}))),function(A){return e.apply(this,arguments)})}]),A}(),U=".sidebarContent .sc-media:not(.hiddenActions) .sc-button-group",R=".l-about-top .sc-button-group:nth-child(1)",D=".l-about-row .sound__soundActions .sc-button-group:nth-child(1)",H=function(){function A(e){Object(a.a)(this,A),this.selector=[D,U,R].join(","),this.type="added",this.utils=e}var e,t,n;return Object(o.a)(A,[{key:"handle",value:function(A){var e=this;A.added.filter(E).map(C).map((function(A){return e.renderDownloadButton(A)}))}},{key:"renderDownloadButton",value:function(A){var e,t=M(),n=t||!t&&-1===location.pathname.indexOf("/sets/");this.isTopSidebar(A)?n&&(e=this.prepareButtonForTop()):e=this.prepareButtonForSidebar(A),e&&e.then((function(e){e&&A.appendChild(e)}))}},{key:"prepareButtonForSidebar",value:(n=Object(r.a)(l.a.mark((function A(e){var t,n,r,a;return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return t=v(),A.next=3,O.a.createLinkExtractor("so-audio").extractLinks({element:e});case 3:if(n=A.sent,r=Object(L.a)(n,1),(a=r[0]).url&&a.filename){A.next=8;break}return A.abrupt("return");case 8:return t.classList.add("sc-sidebar"),t.href=a.url,t.download=a.filename,t.addEventListener("click",this.utils.downloadOnClick),A.abrupt("return",t);case 13:case"end":return A.stop()}}),A,this)}))),function(A){return n.apply(this,arguments)})},{key:"prepareButtonForTop",value:(t=Object(r.a)(l.a.mark((function A(){var e,t,n,r;return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return(e=v()).dataset.position="sidebar",e.style.width=e.style.height="26px",e.classList.add("sc-topbar"),A.next=6,O.a.createLinkExtractor("so-audio").extractLinks({});case 6:if(t=A.sent,n=Object(L.a)(t,1),(r=n[0]).url&&r.filename){A.next=13;break}return this.tracks=t,e.addEventListener("click",this.onDownloadPlaylist.bind(this)),e.classList.remove("sc-button-small"),A.abrupt("return",e);case 13:return e.href=r.url,e.download=r.filename,e.addEventListener("click",this.utils.downloadOnClick),A.abrupt("return",e);case 17:case"end":return A.stop()}}),A,this)}))),function(){return t.apply(this,arguments)})},{key:"onDownloadPlaylist",value:(e=Object(r.a)(l.a.mark((function A(e){return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return e.preventDefault(),e.stopPropagation(),A.next=4,Promise.all(this.tracks);case 4:A.sent.map(B);case 5:case"end":return A.stop()}}),A,this)}))),function(A){return e.apply(this,arguments)})},{key:"isTopSidebar",value:function(A){return null!==A.closest(".l-about-top")}}]),A}();function F(A,e){var t=Object.keys(A);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(A);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(A,e).enumerable}))),t.push.apply(t,n)}return t}function T(A){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?F(Object(t),!0).forEach((function(e){Object(n.a)(A,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(e){Object.defineProperty(A,e,Object.getOwnPropertyDescriptor(t,e))}))}return A}function P(A){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(A){return!1}}();return function(){var t,n=Object(c.a)(A);if(e){var r=Object(c.a)(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(i.a)(this,t)}}var z=function(A){Object(s.a)(n,A);var e,t=P(n);function n(){var A;Object(a.a)(this,n);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return(A=t.call.apply(t,[this].concat(r))).mutationHandlers=[],A.active=1,A}return Object(o.a)(n,[{key:"init",value:(e=Object(r.a)(l.a.mark((function A(){return l.a.wrap((function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,d.a.callFn("getPreferences");case 2:this.settings=A.sent,this.utils=Object(f.a)({preferences:this.settings}),this.active=Number(this.settings.moduleSoundcloud),this.registerMonoListeners(),this.registerListeners(),this.active&&this.initObserver(),this.appendStyle(y);case 9:case"end":return A.stop()}}),A,this)}))),function(){return e.apply(this,arguments)})},{key:"registerListeners",value:function(){var A=this;document.addEventListener("song.download",(function(e){var t=e.detail;A.utils.download(t.filename,t.downloadURL)}))}},{key:"registerMonoListeners",value:function(){var A=this;d.a.onMessage.addListener(function(){var e=Object(r.a)(l.a.mark((function e(t,r,a){var o,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.action,s=t.moduleName,i=t.state,s===n.moduleName){e.next=3;break}return e.abrupt("return");case 3:if("getModuleInfo"!==o){e.next=5;break}return e.abrupt("return",a({state:A.active,moduleName:n.moduleName}));case 5:if("updatePreferences"!==o){e.next=7;break}return e.abrupt("return",(r=t.preferences,A.settings=T(T({},A.settings),{},{preferences:r})));case 7:if("changeState"!==o){e.next=14;break}if(!i){e.next=10;break}return e.abrupt("return",A.initObserver());case 10:A.observer.stop(),document.querySelectorAll(".sf--sc-btn").forEach((function(A){return A.remove()})),document.querySelectorAll('[data-sf-song-ready="1"]').forEach((function(A){A.removeAttribute("data-sf-song-ready")}));case 14:case"end":return e.stop()}var r}),e)})));return function(A,t,n){return e.apply(this,arguments)}}())}},{key:"initObserver",value:function(){this.mutationHandlers=[new J(this.utils),new j(this.utils),new H(this.utils)],M()&&this.mutationHandlers.push(new I);this.observer=new h.a({queries:this.mutationHandlers.map((function(A){return{css:A.selector,callback:A.handle.bind(A),is:A.type}}))}),this.observer.start()}}]),n}(p.a);z.moduleName="soundcloud";var G=new z;g.a.isSingle()&&Object(b.a)(z.moduleName,(function(){return G.init()}),(function(){return!0}))}});